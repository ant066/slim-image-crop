!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=13)}([function(e,t){e.exports='<svg fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h48v48h-48z" fill="none"></path><path d="M34 6h-24c-2.21 0-4 1.79-4 4v28c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4v-24l-8-8zm-10 32c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm6-20h-20v-8h20v8z"></path></svg>'},function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var s=(r=n,a=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(l," */")),o=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot).concat(e," */")}));return[i].concat(o).concat([s]).join("\n")}var r,a,l;return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(i,"}"):i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},s=0;s<this.length;s++){var o=this[s][0];null!=o&&(n[o]=!0)}for(var r=0;r<e.length;r++){var a=e[r];null!=a[0]&&n[a[0]]||(i&&!a[2]?a[2]=i:i&&(a[2]="(".concat(a[2],") and (").concat(i,")")),t.push(a))}},t}},function(e,t,i){"use strict";var n,s={},o=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},r=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}();function a(e,t){for(var i=[],n={},s=0;s<e.length;s++){var o=e[s],r=t.base?o[0]+t.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};n[r]?n[r].parts.push(a):i.push(n[r]={id:r,parts:[a]})}return i}function l(e,t){for(var i=0;i<e.length;i++){var n=e[i],o=s[n.id],r=0;if(o){for(o.refs++;r<o.parts.length;r++)o.parts[r](n.parts[r]);for(;r<n.parts.length;r++)o.parts.push(f(n.parts[r],t))}else{for(var a=[];r<n.parts.length;r++)a.push(f(n.parts[r],t));s[n.id]={id:n.id,refs:1,parts:a}}}}function c(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var n=i.nc;n&&(e.attributes.nonce=n)}if(Object.keys(e.attributes).forEach((function(i){t.setAttribute(i,e.attributes[i])})),"function"==typeof e.insert)e.insert(t);else{var s=r(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var p,u=(p=[],function(e,t){return p[e]=t,p.filter(Boolean).join("\n")});function d(e,t,i,n){var s=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,s);else{var o=document.createTextNode(s),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(o,r[t]):e.appendChild(o)}}function h(e,t,i){var n=i.css,s=i.media,o=i.sourceMap;if(s&&e.setAttribute("media",s),o&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var m=null,v=0;function f(e,t){var i,n,s;if(t.singleton){var o=v++;i=m||(m=c(t)),n=d.bind(null,i,o,!1),s=d.bind(null,i,o,!0)}else i=c(t),n=h.bind(null,i,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o());var i=a(e,t);return l(i,t),function(e){for(var n=[],o=0;o<i.length;o++){var r=i[o],c=s[r.id];c&&(c.refs--,n.push(c))}e&&l(a(e,t),t);for(var p=0;p<n.length;p++){var u=n[p];if(0===u.refs){for(var d=0;d<u.parts.length;d++)u.parts[d]();delete s[u.id]}}}}},function(e,t){e.exports='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M6.13,1,6,16a2,2,0,0,0,2,2H23" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path><path d="M1,6.13,16,6a2,2,0,0,1,2,2V23" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>'},function(e,t){e.exports='<svg id="Layer_1" style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M368,224c26.5,0,48-21.5,48-48c0-26.5-21.5-48-48-48c-26.5,0-48,21.5-48,48C320,202.5,341.5,224,368,224z"></path><path d="M452,64H60c-15.6,0-28,12.7-28,28.3v327.4c0,15.6,12.4,28.3,28,28.3h392c15.6,0,28-12.7,28-28.3V92.3 C480,76.7,467.6,64,452,64z M348.9,261.7c-3-3.5-7.6-6.2-12.8-6.2c-5.1,0-8.7,2.4-12.8,5.7l-18.7,15.8c-3.9,2.8-7,4.7-11.5,4.7 c-4.3,0-8.2-1.6-11-4.1c-1-0.9-2.8-2.6-4.3-4.1L224,215.3c-4-4.6-10-7.5-16.7-7.5c-6.7,0-12.9,3.3-16.8,7.8L64,368.2V107.7 c1-6.8,6.3-11.7,13.1-11.7h357.7c6.9,0,12.5,5.1,12.9,12l0.3,260.4L348.9,261.7z"></path></g></svg>'},function(e,t){e.exports='<svg fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><line x1="3" x2="21" y1="12" y2="12"></line><line x1="3" x2="21" y1="6" y2="6"></line><line x1="3" x2="21" y1="18" y2="18"></line></svg>'},function(e,t,i){var n=i(8);"string"==typeof n&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(3)(n,s);n.locals&&(e.exports=n.locals)},function(e,t,i){(e.exports=i(2)(!1)).push([e.i,".spe-main{width:100%;height:100%;border:1px solid #ddd;display:flex;flex-direction:column}.spe-main *{box-sizing:border-box}.spe-main .spe-toolbar{width:100%;background:#dedede;padding:5px 10px;border-bottom:1px solid #dddddd}.spe-main .spe-toolbar .spe-toolbar-item{cursor:pointer;padding:5px;display:inline-block;margin-right:5px}.spe-main .spe-toolbar .spe-toolbar-item:hover{background:#bfbfbf}.spe-main .spe-toolbar .spe-toolbar-item svg{height:24px;width:24px;user-select:none;pointer-events:none}.spe-main .spe-canvas-wrapper{flex-grow:1;flex-shrink:0;position:relative}.spe-main .spe-canvas-wrapper canvas{position:absolute;top:50%;left:50%;display:block;max-width:calc(100% - 40px);transform:translate(-50%, -50%);max-height:calc(100% - 40px)}.spe-main .spe-sub-toolbar{max-height:100px;height:100px;flex-shrink:0;width:100%;background:#f2f2f2;border-bottom:1px solid #dddddd;overflow:hidden;display:none}.spe-disabled{opacity:0.5;user-select:none;pointer-events:none}\n",""])},function(e,t,i){var n=i(10);"string"==typeof n&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(3)(n,s);n.locals&&(e.exports=n.locals)},function(e,t,i){(e.exports=i(2)(!1)).push([e.i,".spe-crop-menu{height:100%;display:flex;justify-content:center;align-items:center}.spe-crop-menu .spe-crop-menu-item{width:80px;text-align:center;cursor:pointer;padding:10px;border-radius:3px;cursor:pointer;color:#383838}.spe-crop-menu .spe-crop-menu-item:hover{background:#ddd}.spe-crop-menu .spe-crop-menu-item svg{height:30px;width:30px}.spe-crop-menu .spe-crop-menu-item .spe-crop-menu-item-title{margin-top:5px;font-size:14px;user-select:none}.spe-crop-frame{position:fixed;border:2px dashed #fff;z-index:1000002;cursor:move}.spe-crop-frame .spe-frame-resize{height:14px;width:14px;background:#fff;position:absolute}.spe-crop-frame .spe-frame-resize.spe-frame-tl{top:-7px;left:-7px;cursor:nwse-resize}.spe-crop-frame .spe-frame-resize.spe-frame-tr{top:-7px;right:-7px;cursor:nesw-resize}.spe-crop-frame .spe-frame-resize.spe-frame-bl{bottom:-7px;left:-7px;cursor:nesw-resize}.spe-crop-frame .spe-frame-resize.spe-frame-br{bottom:-7px;right:-7px;cursor:nwse-resize}\n",""])},function(e,t,i){var n=i(12);"string"==typeof n&&(n=[[e.i,n,""]]);var s={insert:"head",singleton:!1};i(3)(n,s);n.locals&&(e.exports=n.locals)},function(e,t,i){(e.exports=i(2)(!1)).push([e.i,".spe-image-menu{height:100%;display:flex;justify-content:center;align-items:center}.spe-image-menu .spe-image{height:70px}.spe-image-menu .spe-image img{height:70px;border:1px solid #ddd}.spe-image-menu .spe-image-insert{border:1px solid #ddd;padding:5px 10px;border-radius:3px;background:#ddd;margin:0 15px;cursor:pointer}.spe-image-menu .spe-image-insert:hover{background:#d2d2d2}.spe-image-menu .spe-image-save{display:flex;align-items:center;margin-left:50px;cursor:pointer;justify-content:center}.spe-image-menu .spe-image-save svg{height:30px;width:30px}.spe-image-menu .spe-image-watermark{position:fixed;border:2px solid transparent;z-index:1}.spe-image-menu .spe-image-pos-box{position:relative;width:80px;height:80px;border:1px solid #ddd}.spe-image-menu .spe-image-pos-box>div{height:23px;width:23px;border-radius:3px;background:#ddd;position:absolute;color:#3c3c3c;line-height:25px;text-align:center;font-size:14px;cursor:pointer}.spe-image-menu .spe-image-pos-box>div:hover{background:#d2d2d2}.spe-image-menu .spe-image-pos-box .spe-pos-tl{top:2px;left:2px}.spe-image-menu .spe-image-pos-box .spe-pos-tr{top:2px;right:2px}.spe-image-menu .spe-image-pos-box .spe-pos-ce{top:50%;left:50%;transform:translate(-50%, -50%)}.spe-image-menu .spe-image-pos-box .spe-pos-bl{bottom:2px;left:2px}.spe-image-menu .spe-image-pos-box .spe-pos-br{bottom:2px;right:2px}\n",""])},function(e,t,i){"use strict";i.r(t);i(7),i(9);var n=i(4),s=i.n(n),o=i(0),r=i.n(o),a=i(1),l=i.n(a);function c(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h={icon:s.a,title:"Crop",menu:!0},m=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t,this.options=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(i,!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},h,{options:i}),this.init=this._init.bind(this),this.action=this._action.bind(this),this.createMenu=this._createMenu.bind(this),this.createMenuItem=this._createMenuItem.bind(this),this.initCropFrame=this._initCropFrame.bind(this),this.cropFrameMouseDownHandler=this._cropFrameMouseDownHandler.bind(this),this.cropFrameMouseMoveHandler=this._cropFrameMouseMoveHandler.bind(this),this.cropFrameMouseUpHandler=this._cropFrameMouseUpHandler.bind(this),this.setCropFramePosition=this.setCropFramePosition.bind(this),this.setCropFrameSize=this.setCropFrameSize.bind(this),this.resizeMouseDownHandler=this.resizeMouseDownHandler.bind(this),this.resizeMouseMoveHandler=this.resizeMouseMoveHandler.bind(this),this.resizeMouseUpHandler=this.resizeMouseUpHandler.bind(this),this.cropAction=this.cropAction.bind(this),this.init()}var t,i,n;return t=e,(i=[{key:"_action",value:function(){this.initCropFrame()()}},{key:"_init",value:function(){return this.menu?this.menu:this.menu=this.createMenu()}},{key:"_createMenu",value:function(){var e=this,t=document.createElement("div");return t.classList.add("spe-crop-menu"),[{title:"Free",icon:r.a,action:this._initCropFrame()},{title:"Square",icon:r.a,action:this._initCropFrame(1)},{title:"16/9",icon:r.a,action:this._initCropFrame(16/9)},{title:"5:4",icon:r.a,action:this._initCropFrame(5/4)},{title:"4:3",icon:r.a,action:this._initCropFrame(4/3)},{title:"Save",icon:l.a,action:this.cropAction}].forEach((function(i){t.appendChild(e._createMenuItem(i))})),t}},{key:"_createMenuItem",value:function(e){var t=e.icon,i=e.title,n=e.action,s=document.createElement("div");return s.classList.add("spe-crop-menu-item"),s.innerHTML=t+"<div class='spe-crop-menu-item-title'>".concat(i,"</div>"),s.setAttribute("title",i),s.addEventListener("click",n),s}},{key:"_initCropFrame",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){e.ratio=t;var i=e.editor.canvasEl.getBoundingClientRect(),n=i.left,s=i.top,o=i.bottom,r=i.right,a=i.height,l=i.width;e.cropFrame||(e.cropFrame=document.createElement("div"),e.cropFrame.classList.add("spe-crop-frame"),e.cropFrame.addEventListener("mousedown",e.cropFrameMouseDownHandler),e.cropFrame.addEventListener("mousemove",e.cropFrameMouseMoveHandler),e.cropFrame.addEventListener("mouseup",e.cropFrameMouseUpHandler),e.cropFrame.addEventListener("mouseout",e.cropFrameMouseUpHandler),e.cropFrame.innerHTML='<div class="spe-frame-resize spe-frame-tl" data-value="TL"></div>\n                                            <div class="spe-frame-resize spe-frame-tr" data-value="TR"></div>\n                                            <div class="spe-frame-resize spe-frame-bl" data-value="BL"></div>\n                                            <div class="spe-frame-resize spe-frame-br" data-value="BR"></div>',c(e.cropFrame.getElementsByClassName("spe-frame-resize")).forEach((function(t){t.addEventListener("mousedown",e.resizeMouseDownHandler)})),e.menu.appendChild(e.cropFrame));var p=l/2,u=t?p*t:a/2;u>a?(u=a,t&&(p=u/t)):p>l&&(p=l,t&&(u=p*t)),e.setCropFrameSize(p,u),e.setCropFramePosition((n+r-p)/2,(s+o-u)/2)}}},{key:"_cropFrameMouseDownHandler",value:function(e){this.isMoving=!0;var t=e.clientX,i=e.clientY;this.clientX=t,this.clientY=i,this.oldX=parseInt(this.cropFrame.style.left,10),this.oldY=parseInt(this.cropFrame.style.top,10)}},{key:"_cropFrameMouseMoveHandler",value:function(e){if(this.isMoving){e.preventDefault();var t=e.clientX,i=e.clientY,n=t-this.clientX,s=i-this.clientY,o=this.oldX+n,r=this.oldY+s;this.setCropFramePosition(o,r)}}},{key:"_cropFrameMouseUpHandler",value:function(){this.isMoving=!1}},{key:"setCropFramePosition",value:function(e,t){var i=this.editor.canvasEl.getBoundingClientRect(),n=i.left,s=i.top,o=i.bottom,r=i.right,a=parseInt(this.cropFrame.style.width,10),l=parseInt(this.cropFrame.style.height,10);e<n&&(e=n),t<s&&(t=s),e+a>r&&(e=r-a),t+l>o&&(t=o-l),this.cropFrame.style.top=t,this.cropFrame.style.left=e}},{key:"setCropFrameSize",value:function(e,t){this.cropFrame.style.width=e,this.cropFrame.style.height=t}},{key:"resizeMouseDownHandler",value:function(e){e.stopPropagation(),e.preventDefault();var t=e.target;this.resizeDirection=t.getAttribute("data-value");var i=this.cropFrame.getBoundingClientRect(),n=i.left,s=i.top,o=i.bottom,r=i.right,a=i.width,l=i.height;this.oldWidth=a,this.oldHeight=l,this.oldLeft=n,this.oldTop=s,this.oldBottom=o,this.oldRight=r,document.addEventListener("mousemove",this.resizeMouseMoveHandler),document.addEventListener("mouseup",this.resizeMouseUpHandler)}},{key:"resizeMouseMoveHandler",value:function(e){if(this.resizeDirection){var t,i,n,s,o=e.clientX,r=e.clientY;switch(this.resizeDirection){case"TL":t=this.oldWidth-(o-this.oldLeft),i=this.oldHeight-(r-this.oldTop),n=r,s=o;break;case"TR":t=this.oldWidth+(o-this.oldRight),i=this.oldHeight-(r-this.oldTop),n=r,s=this.oldLeft;break;case"BR":t=this.oldWidth+(o-this.oldRight),i=this.oldHeight+(r-this.oldBottom),n=this.oldTop,s=this.oldLeft;break;case"BL":t=this.oldWidth-(o-this.oldLeft),i=this.oldHeight+(r-this.oldBottom),n=this.oldTop,s=o}i<0||t<0||(this.setCropFrameSize(t,i),this.setCropFramePosition(s,n))}}},{key:"resizeMouseUpHandler",value:function(e){this.resizeDirection=null,document.removeEventListener("mousemove",this.resizeMouseMoveHandler),document.removeEventListener("mouseup",this.resizeMouseUpHandler)}},{key:"cropAction",value:function(){var e=this.cropFrame.getBoundingClientRect(),t=e.left,i=e.top,n=(e.bottom,e.right,e.width),s=e.height,o=this.editor.canvasEl.getBoundingClientRect(),r=t-o.left,a=i-o.top,l=v(this.editor.canvasEl,r,a,n,s);this.editor.draw(l)}}])&&d(t.prototype,i),n&&d(t,n),e}(),v=function(e,t,i,n,s){var o=document.createElement("canvas");return o.setAttribute("crossOrigin","Anonymous"),o.width=n,o.height=s,o.getContext("2d").drawImage(e,t,i,n,s,0,0,n,s),o.toDataURL("image/png")},f=(i(11),i(5));function g(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function b(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function y(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function w(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var x={icon:i.n(f).a,title:"Image",menu:!0,logo:"https://static-znews.zadn.vn/images/logo-zing.svg"},M=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t,this.options=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(i,!0).forEach((function(t){y(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},x,{options:i}),this.init=this._init.bind(this),this.action=this._action.bind(this),this.createMenu=this._createMenu.bind(this),this.initEvents=this._initEvents.bind(this),this.insertLogo=this._insertLogo.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.handleSelectImage=this.handleSelectImage.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.removeSelected=this.removeSelected.bind(this),this.enablePosMenu=this.enablePosMenu.bind(this),this.disablePosMenu=this.disablePosMenu.bind(this),this.changeImagePos=this.changeImagePos.bind(this),this.applyImage=this.applyImage.bind(this),this.init()}var t,i,n;return t=e,(i=[{key:"_init",value:function(){this.menu||(this.menu=this.createMenu(),this.imageList=this.menu.querySelector(".spe-image-item-list"),this.initEvents())}},{key:"_action",value:function(){this.editor.canvasEl.addEventListener("click",this.removeSelected)}},{key:"_createMenu",value:function(){var e=document.createElement("div");e.classList.add("spe-image-menu");var t="<div class='spe-image'>\n                            <img src='".concat(this.options.logo,"'/>\n                        </div>\n                        <div class=\"spe-image-insert\">Ch√®n</div>\n\n                        <div class='spe-image-pos-box spe-disabled'>\n                            <div class='spe-pos-tl' data-value='TL'>TL</div>\n                            <div class='spe-pos-tr' data-value='TR'>TR</div>\n                            <div class='spe-pos-ce' data-value='CE'>CE</div>\n                            <div class='spe-pos-bl' data-value='BL'>BL</div>\n                            <div class='spe-pos-br' data-value='BR'>BR</div>\n                        </div>\n\n                        <div class=\"spe-image-save\">").concat(l.a,'</div>\n                    </div>\n                    \n                    <div class="spe-image-item-list"></div>\n                    ');return e.innerHTML=t,this.insertBtn=e.querySelector(".spe-image-insert"),this.saveBtn=e.querySelector(".spe-image-save"),this.posMenu=e.querySelector(".spe-image-pos-box"),this.posMenuBtns=g(this.posMenu.querySelectorAll("div")),e}},{key:"_initEvents",value:function(){var e=this;this.insertBtn.addEventListener("click",(function(){return e.insertLogo()})),this.posMenuBtns.forEach((function(t){t.addEventListener("click",e.changeImagePos)})),this.saveBtn.addEventListener("click",this.applyImage)}},{key:"_insertLogo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.logo,i=document.createElement("div");i.classList.add("spe-image-watermark");var n=this.editor.canvasEl.getBoundingClientRect(),s=n.height,o=n.width,r=n.left,a=n.top,l=document.createElement("img");l.setAttribute("crossOrigin","anonymous"),l.setAttribute("src",t),i.appendChild(l),this.imageList.appendChild(i),l.onload=function(){var t=l.getBoundingClientRect(),n=t.height/t.width,c=s/10,p=c/n;i.style.height=c+"px",i.style.width=p+"px",i.style.left=r+o-p,i.style.top=a+s-c,l.style.height="100%",l.style.width="100%",i.addEventListener("click",(function(){return e.handleSelectImage(i)}))}}},{key:"changeImagePos",value:function(e){var t,i,n=e.target.getAttribute("data-value"),s=this.editor.canvasEl.getBoundingClientRect(),o=s.height,r=s.width,a=s.left,l=s.top,c=this.imageEl.getBoundingClientRect(),p=c.height,u=c.width;switch(n){case"TL":i=l,t=a;break;case"TR":i=l,t=a+r-u;break;case"CE":i=l+o/2-p/2,t=a+r/2-u/2;break;case"BL":i=l+o-p,t=a;break;case"BR":i=l+o-p,t=a+r-u}this.imageEl.style.left=t+"px",this.imageEl.style.top=i+"px"}},{key:"removeSelected",value:function(){g(this.imageList.querySelectorAll(".spe-image-watermark")).forEach((function(e){e.style.border=" 2px solid transparent",e.style.cursor="move"})),this.imageEl=null,this.disablePosMenu()}},{key:"enablePosMenu",value:function(){this.posMenu.classList.remove("spe-disabled")}},{key:"disablePosMenu",value:function(){this.posMenu.classList.add("spe-disabled")}},{key:"handleSelectImage",value:function(e){this.removeSelected(),this.isMouseDown=!1,this.imageEl=e,this.imageEl.style.border=" 2px dashed #fff",this.imageEl.style.cursor="move",this.imageEl.addEventListener("mousedown",this.onMouseDown),this.enablePosMenu()}},{key:"onMouseDown",value:function(e){this.isMouseDown=!0;var t=this.imageEl.getBoundingClientRect(),i=(t.height,t.width,t.left),n=t.top,s=e.pageX,o=e.pageY;this.imageLeft=s-i,this.imageTop=o-n,e.stopPropagation(),e.preventDefault(),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),this.editor.canvasEl.addEventListener("mouseleave",this.onMouseUp)}},{key:"onMouseMove",value:function(e){if(this.isMouseDown&&this.imageEl){var t=e.pageX,i=e.pageY;this.imageEl.style.top=i-this.imageTop,this.imageEl.style.left=t-this.imageLeft}}},{key:"onMouseUp",value:function(){this.isMouseDown=!1,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}},{key:"applyImage",value:function(){var e=this,t=this.imageList.querySelectorAll(".spe-image-watermark"),i=this.editor.canvasEl.getBoundingClientRect(),n=this.editor.canvasEl.height/i.height;g(t).forEach((function(t){var s=t.querySelector("img");s.setAttribute("crossOrigin","Anonymous");var o=t.getBoundingClientRect(),r=(o.left-i.left)*n,a=(o.top-i.top)*n,l=(o.width-2)*n,c=(o.height-2)*n;e.editor.ctx.drawImage(s,r,a,l,c),t.remove()}))}}])&&w(t.prototype,i),n&&w(t,n),e}(),E=i(6),k=i.n(E);function L(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t,i){return t&&L(e.prototype,t),i&&L(e,i),e}var F=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._bind.call(this),!this.initWrapper(t))throw new Error("Wrapper element must be query string or Element!");this.initModules(i.modules),this.initToolbar(),this.initSubToolbar(),this.initCanvas()}return C(e,[{key:"_bind",value:function(){this.initWrapper=this._initWrapper.bind(this),this.initToolbar=this._initToolbar.bind(this),this.initModules=this._initModules.bind(this),this.initSubToolbar=this._initSubToolbar.bind(this),this.initCanvas=this._initCanvas.bind(this),this.draw=this._draw.bind(this),this.getImage=this.getImage.bind(this)}}]),C(e,[{key:"_initWrapper",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.wrapperEl="string"==typeof e?document.querySelector(e):e,this.wrapperEl instanceof HTMLElement&&(this.el=document.createElement("div"),this.el.classList.add("spe-main"),this.wrapperEl.appendChild(this.el),!0)}},{key:"_initModules",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.modules=[],t.forEach((function(t){switch(t){case"crop":e.modules.push(new m(e));break;case"image":e.modules.push(new M(e))}}))}},{key:"_initCanvas",value:function(){this.canvasWrapperEl=document.createElement("div"),this.canvasWrapperEl.classList.add("spe-canvas-wrapper"),this.canvasEl=document.createElement("canvas"),this.canvasWrapperEl.appendChild(this.canvasEl),this.ctx=this.canvasEl.getContext("2d"),this.el.appendChild(this.canvasWrapperEl)}},{key:"_initToolbar",value:function(){var e=this;this.toolbarEl=document.createElement("div"),this.toolbarEl.classList.add("spe-toolbar"),this.modules.forEach((function(t){var i=document.createElement("div");i.classList.add("spe-toolbar-item");var n=t.options,s=n.icon,o=void 0===s?k.a:s,r=n.title;i.innerHTML=o,i.setAttribute("title",r),i.addEventListener("click",(function(){t.menu?(e.subToolbarEl.innerHTML="",e.subToolbarEl.appendChild(t.menu),e.subToolbarEl.show()):e.subToolbarEl.hide(),t.action&&t.action()})),e.toolbarEl.appendChild(i)})),this.el.appendChild(this.toolbarEl)}},{key:"_initSubToolbar",value:function(){var e=this;this.subToolbarEl=document.createElement("div"),this.subToolbarEl.classList.add("spe-sub-toolbar"),this.subToolbarEl.hide=function(){return e.subToolbarEl.style.display="none"},this.subToolbarEl.show=function(){return e.subToolbarEl.style.display="block"},this.el.appendChild(this.subToolbarEl)}},{key:"_draw",value:function(e){var t=this,i=new Image;i.setAttribute("crossOrigin","anonymous"),i.src=e,i.onload=function(){t.canvasEl.setAttribute("height",i.height+"px"),t.canvasEl.setAttribute("width",i.width+"px"),t.ctx.drawImage(i,0,0)}}},{key:"getImage",value:function(){return this.canvasEl.toDataURL()}}]),e}();t.default=F}]);